#! /usr/bin/env bash

test ! -d distribution && 
  echo ERROR: distribution/ dir not found && 
  exit

while IFS= read -r authoring_dir; do
  pyret_file=$authoring_dir/generate-pyret-images.arr
  if test -f $pyret_file; then
    echo Generating images from $pyret_file
    (cd $authoring_dir; npx pyret --builtin-js-dir lib/pyret-support/js-extras/ -p generate-pyret-images.arr >/dev/null)
  fi
done < <(find lessons -type d -name authoring)
