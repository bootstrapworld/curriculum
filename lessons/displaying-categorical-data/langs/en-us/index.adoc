= Displaying Categorical Data

@description{Students learn to generate and compare pie charts & bar charts, explore other plotting & display functions, and (optionally) design an infographic.}

@lesson-prereqs{contracts, data-cycle}

@keywords{}

@add-to-lang{bar-chart, pie-chart, pie-chart-summarized, bar-chart-summarized, histogram, box-plot, scatter-plot}

[@lesson-intro-table]
|===

| Lesson Goals
| Students will be able to:

* Read pie and bar charts
* Explain the difference between pie and bar charts
* Generate pie and bar charts (among others) from the Animals Dataset

| Student-facing Lesson Goals
|

* Let's use functions to create pie charts, bar graphs and other data displays from Tables.

| Materials
|[.materials-links]
* @link{https://docs.google.com/presentation/d/1c6gMXPZV3duwHQje6H55NkHKUkPjJDwOBRk74hPDk6o/, Lesson slides}

@material-links

| Preparation
|
@preparation
* All students should log into @link{https://code.pyret.org, code.pyret.org (CPO)} and open the "Animals Starter File" they saved from the prior lesson. If they don't have the file, they can open a new @starter-file{animals}.

| Supplemental Resources
|
* @link{https://informationisbeautiful.net/, Information is Beautiful}
* @link{https://www.nytimes.com/2017/05/10/opinion/the-census-wont-collect-lgbt-data-thats-a-problem.html, Opinion: The Census Won't Collect LGBT Data. That's a Problem.}

@lang-prereq

|===


== Pie and Bar Charts @duration{30 minutes}

=== Overview
Students extend their understanding of Contracts and function application, learning new functions that consume Tables and produce displays and plots. They practice the Data Cycle worksheet, now extending into the Analysis phase of the cycle.

=== Launch
[.lesson-instruction]
Where have you seen infographics and graphs used to display data in the real world?

Here is the @vocab{Contract} for a function that makes @vocab{pie charts}:

@show{(contract "pie-chart" '("Table" "String") "Image" )}

And here is an example of _using_ the function:

`pie-chart(animals-table, "legs")`

[.lesson-instruction]
- What is the Name of this function?
- How many inputs are in its @vocab{Domain}?
- In the Interactions Area, type `pie-chart(animals-table, "legs")` and hit Enter. What happens?

@right{@image{images/legsp.png,"A pie chart showing how many animals have each number of legs" ,300}}

Hovering over a pie slice reveals the label, as well as the count and the percentage of the whole. In this example we see that there is 1 animal with 0 legs, representing 3.1% of the population.

We can also resize the window by dragging its borders. This allows us to experiment with the data before closing the window and generating the final, non-interactive image.

The function `pie-chart` consumes a Table of data, along with the _name of a *categorical* column you want to display_. The computer goes through the column, counting the number of times that each value appears. Then it draws a pie slice for each value, with the size of the slice being the percentage of times it appears.  In this example, we used our `animals-table` table as our dataset, and made a pie chart showing the distribution of the number of `legs` across the shelter.

[.strategy-box, cols="1", grid="none", stripes="none"]
|===

a|
@span{.title}{People aren't Hermaphrodite?}
When students make a display of the `sex` of the animals, they will see that some animals are male, some are female and some are hermaphrodites. We use the descriptor _sex_ rather than _gender_ because sex refers to biology, whereas gender refers to identity. Hermaphrodite is the biological term for animals that carry eggs & produce sperm (nearly 1/3 of the non-insect animal species on the planet!). Plants that produce pollen & ovules are also hermaphrodites. While the term was previously used by the medical community to describe intersex people or people who identify as transgender or gender non-binary, it is not biologically accurate. Humans are not able to produce both viable eggs and sperm, so "hermaphrodite" is no longer considered an acceptable term to apply to people.
|===

=== Investigate

Here is the @vocab{Contract} for another function, which makes @vocab{bar charts}:

@show{(contract "bar-chart" '("Table" "String") "Image" )}


[.lesson-instruction]
- Which column of the animals table tells us which species the animal is?
- Use `bar-chart` to make a display showing how many animals there are of each species.
- Experiment with pie and bar charts, passing in different column names. If you get an error message, _read it carefully!_
- What do you think are the rules for what kinds of columns can be used by _bar-chart_ and _pie-chart_?
- When would you want to use one chart instead of another?

To dig deeper into pie charts and bar charts, have students complete @printable-exercise{bar-and-pie-notice.adoc}. They can also focus on one display at a time using @opt-printable-exercise{pie-chart-notice.adoc} or @opt-printable-exercise{bar-chart-notice.adoc}.

[.lesson-instruction]
Have students complete @printable-exercise{matching-bar-to-pie.adoc}.

[.strategy-box, cols="1", grid="none", stripes="none"]
|===

a|
@span{.title}{Extension Activity}

Sometimes we want to summarize a categorical column in a Table, rather than a pie chart. For example, it might be handy to have a table that has a row for dogs, cats, lizards, and rabbits, and then the count of how many of each type there are. Pyret has a function that does exactly this! Try typing this code into the Interactions Area: `count(animals-table, "species")`

What did we get back? `count` is a function that consumes a table and the name of a categorical column, and produces a _new table_ with exactly the columns we want: the name of the category and the number of times that category occurs in the dataset. What are the names of the columns in this new table?

- Use the `count` function to make a table showing the number of animals that are `fixed` (or not) from the shelter.

- Use the `count` function to make a table showing the number of animals of each `sex` from the shelter.

Sometimes the dataset we have is _already_ summarized in a table like this, and we want to make a chart from _that_. In this situation, we want to base our display on the summary table: the size of the pie slice or bar is taken directly from the count column, and the label is taken directly from the value column. When we want to use summarized data to produce a pie chart, we have the contract for another function:

@show{(contract "pie-chart-summarized" '("Table" "String" "String") "Image" )}

And an example of using that function (applying `count` to the `animals-table` to force it into the shape `pie-chart-summarized` needs):

`pie-chart-summarized(count(animals-table,"species"), "value", "count")`

|===

=== Common Misconceptions

* Pie charts and bar charts can show _counts_ or _percentages_ of categorical data. If there are more people with brown hair than blond hair, for example, a pie chart of hair color will have a larger slice or longer bar for "brown" than for "blond". In Pyret, pie charts show percentages, and bar charts show counts.
* A pie chart can only display one categorical variable, but a bar chart might be used to display two or more. Pie charts have a wedge for each represented category. Unlike in bar charts, empty categories will not be included in a pie chart. When comparing bar charts, it is important to read the scales on the y-axes. If the scales do not match, a taller bar may not represent a larger value.
* Bar charts look a lot like another kind of chart - called a "histogram" - which are actually quite different because they display _quantitative_ data, not categorical. This lesson focuses entirely on pie- and bar charts.

=== Synthesize
Confirm that students have correctly matched the displays on @printable-exercise{matching-bar-to-pie.adoc}.
[.lesson-instruction]
--
* What strategies did you use to match the bar charts to the pie charts?
* Which displays do you find it easier to interpret? Why?
* What information is provided in bar charts that is hidden in pie charts? _In a bar chart, categories with no values are shown as empty categories, but there are no wedges for categories with 0% on a pie chart._
* Why might this sometimes be problematic? _Sample Answer: If a service isn't reaching a sector of the population, it's easier to ignore the issue if that population doesn't get represented in the display._
--

Bar Charts and Pie Charts display how much of the sample belongs to each category. If they are based on sample data from a larger population, we use them to _infer_ the proportion of a whole population that might belong to each category.

[.lesson-point]
Bar Charts and Pie Charts are mostly used to _display categorical columns_.

While bars in some bar charts should follow some logical order (alphabetical, small-medium-large, etc), the pie slices and bars can technically be placed in _any_ order, without changing the meaning of the chart.

[.strategy-box, cols="1", grid="none", stripes="none"]
|===

a|
@span{.title}{Mini Project: Making Infographics}
Infographics are a powerful tool for communicating information, especially when made by people who actually understand how to connect visuals to data in meaningful ways. @opt-project{infographic.adoc, infographic-rubric.adoc} is an opportunity for students to become more flexible math thinkers while tapping into their creativity. This project can be made on the computer or with pencil and paper. There's also an @link{pages/infographic-rubric.html, Infographics Rubric} to highlight for you and your students what an excellent infographic includes.
|===

== Analyzing and Interpreting @duration{20 minutes}

=== Overview
Students return to the Data Cycle, focusing on the "Analyze Data" step and using it to build pie and bar charts to answer questions.

=== Launch
Now that you're comfortable making pie and bar charts in Pyret, let's talk about how to use those categorical visualizations in our Data Cycle.

Suppose we start with a simple question: __what's the ratio of fixed to unfixed animals at the shelter?__ Let's use the Data Cycle to get an answer.

@left{@image{images/AskQuestions.png, "Ask Questions icon", 100}} This is an Arithmetic Question. We know it's not a lookup question because there's no ratio written somewhere in the table for us to read. Instead, we'll have to count all the fixed animals and the unfixed animals, then compare the totals.

@vspace{1ex}

@left{@image{images/ConsiderData.png, "Consider Data icon", 100}} We know that we'll need to count every single animal, so we want all the rows. And once we've picked the rows we care about, the only column we want is the `fixed` column.

@vspace{1ex}

@left{@image{images/AnalyzeData.png, "Analyze Data icon", 100}} We could use a bar-chart _or_ a pie-chart to do this analysis, but since we care more about the ratio ("2x as many fixed as unfixed") than the actual count ("20 fixed vs. 10 fixed") a pie chart is a slightly better choice. Once we've decided what to make and we know which rows and columns we're plotting, the next step is to _write the code!_

[.lesson-instruction]
Have students make their pie- or bar-charts. Point out that if they aren't sure how to make one, the Contract Page has all the answers!

@vspace{1ex}

@left{@image{images/InterpretData.png, "Interpret Data icon", 100}} What did our charts tell us? Did we answer the question? In this case, we got a clear answer to our question. But perhaps that's not the end of the story! We might be curious about whether a higher percentage of dogs are spayed and neutered than cats, or whether it's even possible to "fix" a tarantula. _All of this belongs in our data story!_

=== Investigate
Now it's time to practice the complete Data Cycle on your own! For now, you'll start with pre-defined questions. Soon, however, you'll be writing the questions yourselves.

[.lesson-instruction]
Complete @printable-exercise{analyzing-categorical-data.adoc}

=== Synthesize
- How did you choose between a pie-chart or a bar-chart?
- What connections do you see between the "Consider Data" step, and the "Analyze Data" step?
- Do you expect those two steps to match all of the time? Why or why not?
- Did you find the answers in the Interpret Data step? If so, what were they?
- What other questions did your analysis raise?

== Additional Exercises
- @opt-printable-exercise{bar-chart-notice.adoc}
- @opt-printable-exercise{pie-chart-notice.adoc}
