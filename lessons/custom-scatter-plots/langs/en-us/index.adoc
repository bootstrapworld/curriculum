= Custom Scatter Plots

++++
<style>
.strategy-box { width: 100%; }

.comparison * { font-size: 0.75rem !important; }
.comparison td { background: #f7f7f8; padding: 0 !important; }
.comparison .highlight { padding: 0 !important; }

#content .forceShading { background-color: #f7f7f8; }
</style>
++++

@description{Custom scatter plots expose deeper insight into subgroups within a population, motivating students to define their own functions and deepen their analysis.}

@lesson-prereqs{scatter-plots, functions-examples-definitions}

@keywords{piecewise, piece-wise, scatterplot, scatterplots, image scatterplots, Scatterplot, Scatterplots, bubble chart, scatter chart}

[@lesson-intro-table]
|===

| Lesson Goals
| Students will be able to...

* make custom scatter plots using helper functions

| Student-facing Lesson Goals
|
* Let's explore a new Pyret function that lets us make more interesting scatter plots.

| Materials
|[.materials-links]
* @link{https://docs.google.com/presentation/d/1foIZjn6ADpzck0gw-L3f_MEZpt7dnTvBVL2HxuHTwPE/, Lesson Slides}

@material-links

|===

== Image Scatter Plots @duration{40 minutes}

=== Overview

Students are introduced to their first example of a _custom scatter plot_, which makes use of the @show{(code 'image-scatter-plot)} function to replace each animals' dot with the name of the species. They then write code for another custom scatter plot.

=== Launch

You've experimented with scatter plots, which allow us to see the relationship between two quantitative columns in a dataset by drawing a dot for each data point. But not all data points are created equal! In the Animals Dataset, for example, there might be major differences between dogs and rabbits. But when viewing all the animals on the same scatter plot, these differences are impossible to define.

Now that we know how to define functions that draw different shapes, we can start thinking about how to customize the dots on our scatter plots. This not only makes the displays more interesting, but it also makes them more _informative_ and helps us to dig deeper into analyzing the data.

=== Investigate

Let's start with some review, combining our knowledge of row and column lookups with our knowledge of how to define functions.

[.lesson-instruction]
Turn to @printable-exercise{defining-row-functions.adoc}, and complete Number 1-3 at the top of the page.

Review students' answers to these first three questions. It's important to check for understanding before proceeding!

[.lesson-instruction]
Return to @printable-exercise{defining-row-functions.adoc}, and complete the bottom portion of the page to define a function `species-tag`.

Review student answers before having them open the @starter-file{custom-scatter-plot} and read through the code.

[.lesson-instruction]
* How (if at all) does your definition of `species-tag` differ from what's here?
* What else do you Notice?
* What else do you Wonder?
* What are the names of the functions you see defined here? What do they do?

* Click Run and see if you can figure out why the @show{(code 'scatter-plot)} function take in 3 Strings, when there are only two axes?
* Define a row called `animalA`, which is the first row in the table (index 0).
* Define a row called `animalB`, which is the second row in the table (index 1).

The contract for `image-scatter-plot` looks pretty different from other contracts we've seen.

[.forceShading]
--
```
image-scatter-plot :: (
  t :: Table,
  xs :: String,
  ys :: String,
  f  :: (Row -> Image)
) -> Image
```
--

[.lesson-instruction]
What is the Domain of `image-scatter-plot`?

_Table, String, String and... what is that last part?... a Function that consumes a Row and produces an Image!_

[.lesson-instruction]
- Comment-out the `scatter-plot` expression in the program by putting a `#` at the start of line 15. This will "turn off" the expression, by telling Pyret to ignore that line.
- Complete @printable-exercise{pages/custom-scatter-plot-explore.adoc}.

@vspace{1ex}

=== Synthesize

[.lesson-instruction]
How did having the dots labeled with the species change your understanding of the data?

Make sure to direct the conversation back to *Data Science!*
__This scatter plot makes it clear that we may want to analyze each species separately, rather than grouping them all together!__ In the Grouped Samples lesson, students will learn how to do just that.

@span{.center}{@image{images/species-tag.png, "A scatter plot with species names for each animal in place of a small, uniform dot. The images are generated by the species-tag function", 450}

[.lesson-instruction]
What did the other functions in the file do?

The `legs-tag` function _made blue rings whose size was determined by the number of legs the animal had. `age-tag` made stars whose size was double the age of the animal._

[.center]
--
@image{images/legs-tag.png, "A scatter plot with different sized blue rings for each animal in place of a small, uniform dot. The images are generated by the legs-tag function", 422} @image{images/age-tag.png, "A scatter plot with different sized purple stars for each animal in place of a small, uniform dot. The images are generated by the age-tag function", 410}
--
[.lesson-instruction]
* What data type is `species-tag`?
* In your own words, what does the `species-tag` function do?
* In your own words, how does `image-scatter-plot` work?
* What are some other ways you could use columns of the Animals Dataset to display more interesting image-scatter-plots?
* What does an `image-scatter-plot` expression need to have defined, in order to display a scatter plot with the animals' names in place of dots?

== OPTIONAL: Using Conditionals @duration{25 minutes}

=== Overview
Students discover how to use conditionals - piecewise functions in math - to change dot colors and sizes, how "dot appearance" can be used to show more data in a scatter plot, and why that would be valuable.

*NOTE:* Math teachers alike may want their students to confront piecewise functions more deeply, and CS teachers may want to spend more time on conditionals. While not a part of the Data Science pathway, the @link{../piecewise-functions-conditionals/, Piecewise Functions and Conditionals} lesson includes a lot of supporting material and practice pages for these topics.

=== Launch
[.lesson-instruction]
--
So far, we've seen that

* the `scatter-plot` function makes uniform blue dots
* the `image-scatter-plot` function can label each point with some text, a different sized dot, or a star.

What other ideas do you have for how else we could make scatter plots be more interesting than the ones with plain blue dots?
--

_Students might suggest using other colors, using letters, using numbers, using coordinates, using different shapes, using different sizes, etc._

_To get more out of the `image-scatter-plot` function, we'll need to use a different kind of function called a "piecewise function"._

@comment{
[.lesson-instruction]
* Take a moment and make a prediction. How do you think the age of an animal impacts how long it takes to be adopted?
* Which of these scatter plots best matches your prediction?
}

Have students open the @opt-starter-file{piecewise-custom-scatter-plot} and turn to @opt-printable-exercise{pages/species-dot-explore.adoc} to record their thinking about the file.

[.lesson-instruction]
--
* What do you Notice?
* What do you Wonder?
* How is this program similar to the one that made the `image-scatter-plot` with species labels?
* How is this code different?
* Click Run.
* What do you Notice?
* What do you Wonder?

@span{.center}{@image{images/age-v-weeks-species-dot.png, "Age v. Weeks Scatter Plot", 450}}

* What does this new visualization tell us about the relationship between age and weeks?
* What other analysis would be helpful here?
--

=== Investigate

Using @opt-printable-exercise{species-dot-dr.adoc}, talk students through what the Contract, Examples, and Definition for a piecewise function might look like.

[.lesson-instruction]
* What is the contract for `species-dot`?
* What is the purpose of `species-dot`?
* How many examples do we need to write?

Have students turn to @opt-printable-exercise{sex-dot-dr.adoc} and write a new helper function that will make differently-colored dots based on the animals' sex.

Make sure that students write the Contract and Purpose Statement __first__ , and check in with their partner __and__ the teacher before proceeding.

Once they've got the Contract and Purpose Statement, have them come up with `examples:` for _each sex_. Once again, have them check with a partner _and_ the teacher before finishing the page.

[.lesson-instruction]
Once another student _and_ the teacher have checked your work, type the `sex-dot` function into your starter file, and use it to make an `image-scatter-plot` using `age` as the x-axis and `weeks` as the y-axis.

Debrief, and ask students to explain what the code does. Pay special attention to students' ability to articulate the "if/then" statements!

[.lesson-instruction]
- Turn to @opt-printable-exercise{pages/species-image-explore.adoc} and open the @opt-starter-file{custom-animals} Starter File.
- Notice and Wonder about the code and complete the first couple of questions before running the program to reveal the scatter plot.
- How is this code similar to other code we've seen?
- How is this program different from other programs we've seen using `image-scatter-plot`?
- How does using clip art help us to better understand the data?
- What risks might there be to using clip art in displays?
- We have seen a lot of different `image-scatter-plot` styles today. What ideas do you have for how `image-scatter-plot` could be used to deepen the analysis of your dataset?


[.strategy-box, cols="1a", grid="none", stripes="none"]
|===
|
@span{.title}{ Optional: When your conditional is _already_ a Boolean }
If you have time or students who are ready for a challenge, you can also have them make a scatter plot for dots distinguishing whether the animal is fixed or not using the directions at the end of the starter file or @opt-printable-exercise{fixed-dot-dr.adoc}. Students will discover that this is a little different from the other two functions they've seen because `fixed` is already a Boolean column! The code will work if written in either of the following ways:
[.comparison, cols="<4a,<3a", options="header"]
!===
! Checking the Boolean
! Using the Boolean Directly

!
```
fun fixed-dot(r):
  if      (r["fixed"] == true) : circle(5, "solid", "green")
  else if (r["fixed"] == false): circle(5, "solid", "black")
  end
end
```
!
```
fun fixed-dot(r):
  if r["fixed"]: circle(5, "solid", "green")
  else: circle(5, "solid", "black")
  end
end
```
!===

For students who are really ready for a challenge, direct them to the @opt-starter-file{custom-scatter-plot-w-range} and @opt-printable-exercise{value-range-dot-explore.adoc}

|===


=== Synthesize
How do piecewise functions expand what is possible with the `image-scatter-plot` function?
