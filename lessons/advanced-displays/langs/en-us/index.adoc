= Custom Scatter Plots

++++
<style>
.strategy-box { width: 100%; }

.comparison * { font-size: 0.75rem !important; }
.comparison td { background: #f7f7f8; padding: 0 !important; }
.comparison .highlight { padding: 0 !important; }

#content .forceShading { background-color: #f7f7f8; }
</style>
++++

@description{Custom scatter plots expose deeper insight into subgroups within a population, motivating students to define their own functions and deepen their analysis.}

@lesson-prereqs{scatter-plots, functions-examples-definitions, ds-intro}

@keywords{piecewise, piece-wise, scatter plot, scatter plots, image scatterplots, bubble chart, scatter chart}

@add-to-lang{image-scatter-plots}

[@lesson-intro-table]
|===

| Lesson Goals
| Students will be able to...

* make custom scatter plots using helper functions

| Student-facing Lesson Goals
|
* Let's explore a new Pyret function that lets us make more interesting scatter plots.

| Materials
|[.materials-links]

@material-links

|===

== Image Scatter Plots @duration{40 minutes}

=== Overview

Students are introduced to their first example of a _custom scatter plot_, which makes use of the @show{(code 'image-scatter-plot)} function to replace each animals' dot with the name of the species. They then write code for another custom scatter plot.

=== Launch

Not all data points are created equal! Dogs and rabbits are very different, but when viewing all the animals on the same scatter plot, these differences are hidden.

This makes the displays more interesting, and helps us to dig deeper into analyzing the data.

@center{@image{images/age-v-weeks.gif, "Age v. Weeks Scatter Plot", 450}}

=== Investigate

Let's start with some review, combining our knowledge of row and column lookups with our knowledge of how to define functions. _Note: Confirm that students' responses are correct before moving from one page to the next (below). Checking for understanding is crucial here._

[.lesson-instruction]
- Turn to @printable-exercise{defining-row-functions.adoc}, and complete numbers 1-3 at the top of the page.
- When you are confident with the code you have written - check with your teacher or a partner - complete the rest of the page to define a function `species-tag`.
- Now, open @starter-file{custom-scatter-plot}. Does your definition of `species-tag` match what you see here?
- What do you Notice? What do you Wonder?
- What functions do you see defined? What do they do? What Rows do you see defined?

The contract for `image-scatter-plot` looks pretty different from other contracts we've seen.

[.forceShading]
--
```
image-scatter-plot :: (
  t  :: Table,
  xs :: String,
  ys :: String,
  f  :: (Row -> Image)
) -> Image
```
--

The function `image-scatter-plot` has an interesting Domain: _Table, String, String and... what is that last part?... *a Function that consumes a Row and produces an Image*!_

[.lesson-instruction]
- Complete @printable-exercise{pages/custom-scatter-plot-explore.adoc}.
- As you work, consider how `image-scatter-plot` is different from other functions we've seen, and how it might be useful to our data analysis.

=== Synthesize

Ask students how having the dots labeled with the species changes their understanding of the data. Students should recognize that the `species-tag` @vocab{scatter plot} makes it clear that we may want to analyze each species separately, rather than grouping them all together. (In the Grouped Samples lesson, students will learn how to do just that!)

Ensure that students understand what the various functions in the file do. The `species-tag` function labeled dots with the species:

@center{@image{images/species-tag.png, "A scatter plot with species names for each animal in place of a small, uniform dot. The images are generated by the species-tag function", 450}}

The `legs-tag` function made blue rings whose size was determined by the number of legs the animal had:

@center{@image{images/legs-tag.png, "A scatter plot with different sized blue rings for each animal in place of a small, uniform dot. The images are generated by the legs-tag function", 422}}

And the `age-tag` function made stars whose size was double the age of the animal:

@center{@image{images/age-tag.png, "A scatter plot with different sized purple stars for each animal in place of a small, uniform dot. The images are generated by the age-tag function", 410}}

[.lesson-instruction]
* What @vocab{data type} is `species-tag`?
** _A function that consumes a Row and produces an Image_
* How does `image-scatter-plot` work?
** _It consumes a Table, a String, a String, and a Function that consumes a Row and produces an Image. It can label each point with some text, a different sized dot, or a star._
* What are some other ways you could use columns of the Animals Dataset to display more interesting image-scatter-plots?
** _Answers will vary._
* What does an `image-scatter-plot` expression need to have defined in order to display a scatter plot with the animals' names in place of dots?
** _We would need to define a `name-tag` helper function._

To close this segment of the lesson, invite students to consider how `image-scatter-plot` might be useful to their _own_ analysis.

== Optional: Using Conditionals @duration{25 minutes}

=== Overview
Students discover how to use @vocab{conditionals} - @vocab{piecewise functions} in math - to change dot colors and sizes, how "dot appearance" can be used to show more data in a scatter plot, and why that would be valuable.

*NOTE:* Math teachers may want their students to confront piecewise functions more deeply, and CS teachers may want to spend more time on conditionals. While not a part of the Data Science pathway, the @lesson-link{piecewise-functions-conditionals/} lesson includes a lot of supporting material and practice pages for these topics, including the @link{pages/notes-piecewise-functions.html, student notes on piecewise functions}.

=== Launch
So far, we've seen that...

* the `scatter-plot` function makes uniform blue dots
* the `image-scatter-plot` function can label each point with some text, a different sized dot, or a star.

Explain to students that to get more out of the `image-scatter-plot` function, we'll need to use a different kind of function called a "piecewise function".

@comment{
[.lesson-instruction]
* Take a moment and make a prediction. How do you think the age of an animal impacts how long it takes to be adopted?
* Which of these scatter plots best matches your prediction?
}

[.lesson-instruction]
--
* Open the @opt-starter-file{piecewise-custom-scatter-plot} and complete @opt-printable-exercise{pages/species-dot-explore.adoc}.

@center{@image{images/age-v-weeks-species-dot.png, "Age v. Weeks Scatter Plot", 450}}

* What does this new visualization (above) tell us about the relationship between age and weeks?
** _In general, as an animal gets older, the weeks to adoption increase. This appears to be true for both dogs (black dots) and cats (orange dots)._
* What other analysis would be helpful here?
** _Sample answer: It might be interesting to look at the outliers to understand why some animals' adoptions take a longer amount of time._
--

=== Investigate

[.lesson-instruction]
* Open @opt-printable-exercise{species-dot-dr.adoc}
* What is the contract for `species-dot`?
** _The function name is `species-dot`, its Domain is Row, and its Range is Image._
* What is the purpose of `species-dot`?
** _It takes in a Row from the animals table and returns a solid, 5px circle using black for dog, orange for cat, pink for rabbit, red for tarantula, green for lizard and blue for snail._
* How many examples do we need to write?
** _We need to write six examples, one for each species._
* Optional: Complete the @opt-printable-exercise{sex-dot-dr.adoc}, to write a new helper function that will make differently-colored dots based on the animals' sex.

Make sure that students write the Contract __first__ , and check in with their partner __and__ the teacher before proceeding. Once they've got the Contract, have them come up with `examples:` for _each sex_. Once again, have them check with a partner _and_ the teacher before finishing the page.

Debrief, and ask students to explain what the code does. Pay special attention to students' ability to articulate the "if/then" statements!

[.lesson-instruction]
- Turn to @opt-printable-exercise{pages/animal-image-explore.adoc} and open the @opt-starter-file{custom-animals} Starter File.
- How does using clipart help us to better understand the data?
** _The images are cool! And they make it so easy to understand whether the species are evenly distributed or clustered._
- What _risks_ might there be to using clipart in displays?
** _Sample response: Clipart of humans runs a serious risk of stereotyping or excluding populations!_
- We have seen a lot of different image scatter plots today! What ideas do you have for how `image-scatter-plot` could be used to deepen the analysis of your dataset?


[.strategy-box, cols="1a", grid="none", stripes="none"]
|===
|
@span{.title}{ Optional: When your conditional is _already_ a Boolean }
If you have time or students who are ready for a challenge, you can also have them make a scatter plot for dots distinguishing whether the animal is fixed or not using the directions at the end of the starter file or @opt-printable-exercise{fixed-dot-dr.adoc}. Students will discover that this is a little different from the other two functions they've seen because `fixed` is already a Boolean column! The code will work if written in either of the following ways:
[.comparison, cols="<4a,<3a", options="header"]
!===
! Checking the Boolean
! Using the Boolean Directly

!
```
fun fixed-dot(r):
  if      (r["fixed"] == true) : circle(5, "solid", "green")
  else if (r["fixed"] == false): circle(5, "solid", "black")
  end
end
```
!
```
fun fixed-dot(r):
  if r["fixed"]: circle(5, "solid", "green")
  else: circle(5, "solid", "black")
  end
end
```
!===

For students who are really ready for a challenge, direct them to the @opt-starter-file{custom-scatter-plot-w-range} and @opt-printable-exercise{value-range-dot-explore.adoc}

|===


=== Synthesize
How do piecewise functions expand what is possible with the `image-scatter-plot` function?
