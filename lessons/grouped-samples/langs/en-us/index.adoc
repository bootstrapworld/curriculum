= Grouped Samples

@description{Students practice creating subsets and think about why it might sometimes be useful to answer questions about a dataset through the lens of specific subsets.}

@lesson-prereqs{defining-table-functions}

@keywords{}

[@lesson-intro-table]
|===
| Lesson Goals
| Students will be able to...

* Make grouped samples from a population

| Student-facing Lesson Goals
|

* Let's combine what we know about sampling and filtering with creating displays.

| Materials
|[.materials-links]
@ifproglang{pyret}{
* @link{https://docs.google.com/presentation/d/1-LPRD7C7xtfHDGeze4v71q53qf5gJgJ-F68pjKY9KCs/, Lesson slides}
}
@ifproglang{codap}{
* @link{https://docs.google.com/presentation/d/1QGQgB__gZkNjx5JvTJ-Tu3jcbhB3wBv8W7-oMviBL7k/edit#slide=id.g930a424983_0_29,  Lesson slides}
}

@material-links

| Preparation
|
@ifproglang{pyret}{
* All students should log into @link{https://code.pyret.org, CPO} and open the "Animals Starter File" they saved from the prior lesson. If they don't have the file, they can open a new one from @starter-file{animals}.
}


|===


== Problems with a Single Population @duration{10 minutes}

=== Overview
This activity is all about @vocab{grouped samples}: Students make a bunch of subsets from the Animals Dataset, and see how each subset might answer the same question differently.

=== Launch
When looking at a scatter plot of our animals, it looks like the amount an animal weighs may have something to do with how long it takes to be adopted.
@span{.center}{@image{images/scatter-plot.png,"A scatter plot with dots loosely clustered around a line with a positive slope",550}}

But if we label the dots by animal, we notice _every data point_ after 25 pounds belongs to a dog from the shelter! The cats are all clumped together in the lower weight range, making it hard to see how weeks to adoption may relate to a cat's weight.

@span{.center}{@image{images/image-scatter-plot.png,"A scatter plot with images of each species of animal in place of the dots, loosely clustered around a line with a positive slope",550}}

=== Investigate
Divide the class into groups of 3-4, with one student identified as the "reporter".

[.lesson-instruction]
- Looking at this scatterplot, does it make sense to analyze all the animals together? Why or why not?
- Are there some questions where it would be important to break up the population into species-specific populations? What are they?
- Are there some questions where it would be important to keep the whole population together? What are they?

=== Synthesize
Have the reporters share their findings with the class.

Imagine that you've been handed a dataset from a country where half the people are wealthy and have access to amazing medical care, and the other half are poor and have no healthcare. If we took a random sample of the population as a whole, we might think that they are generally middle-income and have average health. But if we ask the same question about the two groups _separately_, we would discover inequality hiding in plain sight!

[.lesson-instruction]
* Why might it be important to look at a subset of a population?
* Why is it sometimes bad to only take random samples?

== Grouped Samples @duration{20 minutes}

=== Launch
Ultimately, it might make more sense to ask certain questions about "just the cats" or "just the dogs". Averaging every animal together will give us an answer, but they may not be _useful_ answers.

[.lesson-point]
Sometimes important facts about samples get _lost_ if we mix them with the rest of the population!

Data Scientists define @vocab{grouped samples} of datasets, breaking them up into sub-groups that may be helpful in their analysis.

@ifproglang{pyret}{

Earlier, you learned how to define values in Pyret. We can define Numbers, Strings, Images, and even rows:

  name = "Flannery"
  age  = 16
  logo = star(50, "solid", "red")
  sasha= animals-table.row-n(0)

Let's use this skill to define __Tables...__}

=== Investigate
@ifproglang{pyret}{
We already know how to define values, and how to filter a dataset. So let’s put those skills together to define a grouped sample of the dogs in the shelter:
----
dogs  = animals-table.filter(is-dog)
----
}

[.lesson-instruction]
--
A “kitten” is an animal who _is a cat_ and who _is young_. How would you define a table of just kittens?

* Turn to @printable-exercise{pages/samples-from-animals-dataset.adoc}, and see what @ifproglang{pyret}{code} @ifproglang{codap}{sequence of Transformers} will compute whether or not an animal is a kitten.

* Can you fill in the code for the other grouped samples?
@ifproglang{pyret}{
* When you're done, type these definitions into the Definitions Area.}

* Make a bar chart showing the distribution of `sex` in the `kittens` subset @ifproglang{pyret}{, by typing `bar-chart(kittens, "sex")`}.

* Make bar charts showing the `sex` column for every grouped sample. Which one best represents the distribution of species for the whole population? Why?
--

=== Synthesize
Debrief with students. Thoughtful question: how could we filter _and_ sort a table? How can we combine methods?

== Displaying Samples @duration{20 minutes}

=== Overview
Students revisit the data display activity, now using the samples they created.

=== Launch
Making grouped and random samples is a powerful skill to have, which allows us to dig deeper than just making charts or asking questions about a whole dataset. Now that we know how to make subsets, we can make much more sophisticated displays!

Let's start with question: __what's the ratio of fixed to unfixed *cats* at the shelter?__ Let's use the Data Cycle to get an answer, using our knowledge of grouped samples.

@left{@image{images/AskQuestions.png, "Ask Questions icon", 100}} This is an Arithmetic Question. We know it's not a lookup question because there's no ratio written somewhere in the table for us to read. Instead, we'll have to count all the fixed cats and the unfixed cats, then compare the totals.

@vspace{1ex}

@left{@image{images/ConsiderData.png, "Consider Data icon", 100}} We know that we'll need to count *only the cats!*, and can ignore everything else. And once we've picked the rows for cats, the only column we want is the `fixed` column. This is a huge hint that *we'll need to filter the dataset!*

@vspace{1ex}

@left{@image{images/AnalyzeData.png, "Analyze Data icon", 100}} We could use a bar-chart _or_ a pie-chart to do this analysis, but since we care more about the ratio ("2x as many fixed as unfixed") than the actual count ("20 fixed vs. 10 fixed") a pie chart is a slightly better choice. Once we've decided what to make and we know which rows and columns we're plotting, the next step is to _write the code!_

@vspace{1ex}

@left{@image{images/InterpretData.png, "Interpret Data icon", 100}} What did our charts tell us? Did we answer the question? In this case, we got a clear answer to our question. But perhaps that's not the end of the story! We might be curious about whether a higher percentage of dogs are spayed and neutered than cats, or whether it's even possible to "fix" a tarantula. _All of this belongs in our data story!_

=== Investigate
[.lesson-instruction]
- Complete @printable-exercise{pages/data-displays2.adoc}, using what you've learned about samples to make more sophisticated data displays.
- Complete @printable-exercise{pages/analyzing-categorical-data2.adoc}.

=== Synthesize
- What connections do you see between the "Consider Data" and "Analyze Data" steps?
- How do we know when we need to filter? How do we know when we _don't?_
