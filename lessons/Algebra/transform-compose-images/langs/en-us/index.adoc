= Transforming and Composing Images
++++
<style>
#content .whiteBG img {background: white;}
#content .strategy-box .editbox { width: auto; }
#content .lesson-instruction .editbox {width: auto;}
</style>
++++

@description{Students explore image transformation and composition, applying their knowledge of ratios and coordinates to scale and position shapes precisely while recreating images of flags of varying complexity.}

@lesson-prereqs{defining-values}

@keywords{ratio, proportion, coordinate plane, proportional, scaling}

@add-to-lang{put-image}

[@lesson-intro-table]
|===

| Lesson Goals
| Students will be able to:

- Put one image on top of another, using the `put-image` function.
- Decompose complex images into parts.
- Combine and manipulate images to create more complex images.

| Student-facing Goals
|
- Let's learn how to compose images by placing one image on top of another.
- Let's make complex images like flags using code.

| Materials
|[.materials-links]
@material-links

| Supplemental Materials
|[.materials-links]
@opt-material-links

| Preparation
|
@preparation{
- For some students, the use of graph paper for this activity will make a big difference!
- There is an optional interactive Desmos activity in the lesson. If you would like to use it, decide how you will share it with students and, if you are using our Google Slides, add the appropriate link to the slide deck. _If you're a first-time Desmos user, fear not!_ @dist-link{pages/desmos-instructions.adoc, _Here's what you need to do._}
}

|===

== Putting Images Together @duration{20 minutes}

=== Overview
Students learn about the `put-image` function, which uses coordinates to position one image on top of the other. Students think through what coordinates will place a solid red circle on top of a rectangular background, in a variety of different locations.

=== Launch
As you've already seen, `overlay` sticks two images together, so that the _center_ of the first image is placed exactly on top of the _center_ of the second image. But what if we want to put the dot somewhere besides the center?

Instead of centering the top image on the bottom image, the `put-image` function specifies where on the bottom image to place the center of the top image.

@lesson-point{
Think of the background image as a sheet of graph paper with the @vocab{origin} (0,0) in the bottom left corner.

The numbers in `put-image` specify the point on the paper where the center of the top image should be placed.
}

@slidebreak

@lesson-instruction{

- Turn to @printable-exercise{japan-estimating-coordinates.adoc}. 
- The code beneath each image is missing the x and y coordinates specifying where to place the dot.
- Use logic and proportional reasoning to identify what the x- and y-coordinate of the dot's location should be for each image to complete the code!
}

@slidebreak

@QandA{
@Q{What strategies did you use to estimate the coordinates?}
@A{Answers will vary, but make sure the conversation is anchored around the fact that the background is 300x200.}
}

=== Investigate
Let's apply what we just learned about `put-image` to getting the Japanese flag building correctly. 

We're about to look at some code in the @starter-file{flags}. The programmer included a series of special lines in this file - called @vocab{comments} - that will never be read by the computer.  Comments are a way for programmers to leave notes for one another, and even for a single programmer to keep track of _their own thinking_ for when they come back to their code another day.

@lesson-point{
Professional programmers use comments _all the time!_
}

Most professional programmers work with teams who need to be able to follow each other's thinking in order to collaborate efficiently. And many programs are written and maintained by a series of people, who come and go over the years, and need to able to follow each other's thinking even if they never meet each other!

@slidebreak

@lesson-instruction{
- Open the @starter-file{flags} and click "Run".
- Turn to @printable-exercise{put-image-investigate.adoc} and complete the first section (titled Japan).
}

@teacher{
For students who finish early, there is an optional extension activity in this starter file about writing code to generate the image of the flag of Somalia, but there are many more flags and starter files to come so don't hold up your class for students to work on it.
}

=== Synthesize

Could we completely replace `overlay` with `put-image`? Why or why not?

== Transforming Shapes for Composition @duration{30 minutes}

=== Overview
Students will use proportional reasoning to determine what sizes various flag components should be and where to position them. The first starterfile builds reasoning with classic three-stripe flag designs. The second starterfile focuses on the Puerto Rican flag and will support students in understanding much more complex designs.

=== Launch

@lesson-instruction{
- Open the @starter-file{flags-2} and click "Run".
- Complete the second section of @printable-exercise{put-image-investigate.adoc}, titled The Netherlands.
- When you've answered all of the questions, continue working through the starter file.
}

@teacher{The primary goal of this file is for students to practice thinking about the dimensions of flag stripes as fractions of the full dimensions of the flag. There are many sections of this starter file, and some students will make it through the challenges. Some students may only complete one flag. All of them will be using their proportional reasoning, and synthesizing how to apply put-image to locate images on the coordinate grid.
}

=== Investigate

Now that we've mastered the most basic flag forms, we're ready to tackle a more complex design.

@lesson-instruction{
- We're going to transform a pile of misdefined shapes into the flag of Puerto Rico by fixing the code.
- Open the @starter-file{flags-pr} and click "Run".
- With your partner, follow the "Do Now" directions in the commented code.
}

[cols="^.^13a, ^.^1a, ^.^13a", stripes="none", frame="none", grid="none"]
|===
| @image{images/puerto-rico-jumble.png} | &rarr; |@image{images/pr-flag.png}
|===

=== Synthesize

Why is it useful to define each part of the flag first, before stitching the images together?

== Additional Exercises

- @opt-starter-file{flags-desmos} - Match official flag ratios to code defining background rectangles with corresponding proportions. Then match images to code using `overlay` and `put-image`. 

- @opt-printable-exercise{alaska-flag.adoc} - This page engages students with the @opt-starter-file{flags-ak} for a quick dive into why it’s more efficient to @vocab{define} shapes before building the image. 

- @opt-starter-file{flags-lebanon} - For practice @vocab{scaling} imported graphics

- @opt-starter-file{flags-mx} - Similar to the Puerto Rico Flag Starter File, but this one involves an imported image

- @opt-starter-file{flags-turkey} - For a fun function-composition puzzle

- @opt-starter-file{flags-trinidad} - If you’ve already studied Pythagorean Theorem and are ready to apply it

@ifproglang{wescheme}{
@strategy{Why is it so Hard to Center a `star`?}{


We can think about using `put-image` the same way we think about making a collage: we "grab" an image by holding it at a specific point, then place it atop another image. For the red circle on @printable-exercise{japan-estimating-coordinates.adoc}, we are picking up the image by it's _center_. The same is true for squares, rectangles, and many other shapes.

But not all shapes are so intuitive! Stars and triangles, for example, are not "grabbed" by their centers. Instead, they are "grabbed" by the center of their _bounding box_. A bounding box is the tightest possible rectangle that can be drawn around an image.

Try drawing a star on a piece of paper with a dot at its center. Then, draw a rectangle whose edges touch its top, bottom, left-most, and right-most points. You'll find that the center of the bounding box is not the same as the center of the star!
}
}

