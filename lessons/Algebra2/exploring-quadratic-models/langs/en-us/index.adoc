= Exploring Quadratic Models

@description{Students investigate quadratic relationships in data about Fuel Efficiency, using an inquiry-based model of sense-making, hypothesizing, modeling and testing. They are introduced to table transformations and inverse functions, which are used to fit quadratic models onto nonlinear data.}

@lesson-prereqs{exploring-linear-models, lookups}

@keywords{quadratic, square, coefficient}

[@lesson-intro-table]
|===

| Lesson Goals
| Students will be able to...

* Read and interpret real-world data, presented in a scatter plot
* Model quadratic relationships using functions

| Student-facing Lesson Goals
|

* Let's use Pyret to model quadratic relationships in data


| Materials
|[.materials-links]
@material-links

| Preparation
|
* All students should pull up their @online-exercise{program-list} and, open the @online-exercise{https://code.pyret.org/editor#share=1RESEiKCepBRV3_AbthDydHaq5b9BN2zy, Fuel Efficiency Starter File}.

| Key Points For The Facilitator
|
* TBD
|===

== Looking for Patterns @duration{20 minutes}

=== Overview
Students explore the @online-exercise{https://code.pyret.org/editor#share=1RESEiKCepBRV3_AbthDydHaq5b9BN2zy, Fuel Efficiency Starter File}, and create scatter plots to search for relationships between columns. They share and discuss their findings with the class, discovering the limitations of linear models.

=== Launch

When you're driving, what speed will save you the most money on gas?

[.lesson-instruction]
- Open the @online-exercise{https://code.pyret.org/editor#share=1RESEiKCepBRV3_AbthDydHaq5b9BN2zy, Fuel Efficiency Starter File}
- From the File menu, select "Save a Copy", and click "Run".
- Working in pairs or small groups, complete questions 1-8 of @printable-exercise{pages/exploring-mpg.adoc}.

Review student answers to confirm that students see a _non-linear_ relationship in the dataset with a relatively strong correlation.

=== Investigate

@left{@image{images/fuel-efficiency-quadratic.png}}
There's definitely a relationship here. Even though some cars are more efficient than others, fuel efficiency generally increases from 15 to roughly 55mph. But after 55mph, fuel efficiency _decreases._

[.lesson-instruction]
- Let's try to build a linear model for this data!
- Working in pairs or small groups, complete the rest of of @printable-exercise{pages/exploring-mpg.adoc}.

By now you've tried to fit quite a few linear models to this data, and we're not getting anywhere!

[cols="^.^1a,^.^1a,^.^1a", frame="none", stripes="none"]
|===
| We can build linear models that fit the increasing half of the data...
| We can build linear models that fit the decreasing half of the data...
| We can build linear models that try to split the difference...

| @image{images/fuel-efficiency-linear1.png}
| @image{images/fuel-efficiency-linear2.png}
| @image{images/fuel-efficiency-linear3.png}
|===

...but all of them are so far away from so many points, and our @math{R^2} is pretty bad.

=== Synthesize

- Why aren't linear models working for us?
- What else could we try?

== Fitting Quadratic Models @duration{35 minutes}

=== Overview

Students are introduced to quadratic models, and extend the sampling techniques from the linear models lesson into quadratic relationships.

=== Launch

Linear models are great for fitting simple relationships. But the real world isn't so simple, and more often than not linear models are just too primitive to handle that complexity.

Relationships that rise and fall like this are called @vocab{quadratic relationships}. They form shapes that look like arches, called parabolas. Sometimes the data only includes the _rising_ part of the parabola, sometimes it only includes the _falling_ part, and and sometimes it includes both!

Quadratic relationships show up all the time!

- When an athlete is young, they improve as they get stronger and more skilled. But as they age, they begin to lose their speed and strength.
- A ball dropped from a tall building will get faster and faster as it falls.
- Many nutrients are good for you, and the more you take the healthier you are...up to a point. After that, too much of a mineral or vitamin can cause problems.

[.strategy-box, cols="1", grid="none", stripes="none"]
|===

|
@span{.title}{Going Deeper: Interaction Effects}

We often think about variables of a model being _independent_ from one another, each contributing a little to the outcome we are measuring. But sometimes one input will amplify the result of another input, meaning their combined contribution is greater than the sum of their separate contributions.

A quadratic relationship often means that one or more variables is _interacting_ with another variable. In our miles-per-gallon example, it turns out that a linear increase in speed has a _more than linear effect_ on mpg!
|===

[.lesson-instruction]
Can you think of other real-world examples where a relationship is likely quadratic?

You should already be familiar with the different forms of linear models:

[cols="^1,^1,^1", options="header"]
|===
| Standard 			| Point-slope				| Slope-intercept
| @math{Ax+By = C}	| @math{y-y_1 = m(x-x_1)}	| @math{y = mx+b}
|===

Depending on what part of the model we care about most, we might choose to use one display over another.

The same is true for quadratic models:

[cols="^1,^1,^1", options="header"]
|===
| Standard Form 		| Vertex Form			| Factored Form
| @math{y=ax^2+bx+c}	| @math{y=a(x−h)^2+k}	| @math{y=a(x−r_1)(x−r_2)}
|===

Depending on what part of the model we care about most, we might choose to use one display over another.

- Standard Form makes it easy to find the y-intercept of the parabola @math{c}
- Vertex Form makes it easy to find the vertex (minima or maxima) of the parabola
- Factored Form makes it easy to find the roots of the parabola

[.lesson-instruction]
Given what we've already found out about this dataset, which form should we start with?

In this case, we've already come to some conclusions about the @vocab{vertex} of our parabola, where cars are most fuel-efficient: *45mph*. That makes Vertex Form a useful place to start, since we already know the value of @math{H}:

@center{@math{y=a(x-45)^2+k}}

Now we need to figure out the values of @math{a} and @math{k}!

=== Investigate

But what do each of the coefficients in Vertex Form mean?

[.lesson-instruction]
- Open @online-exercise{https://www.desmos.com/calculator/geyx4aetop, Exploring Quadratics} in Desmos.
- Use Desmos to complete @printable-exercise{graphing-models.adoc}.

Now that we have a sense for what these coefficients mean, let's try to model the speed-v-mpg relationship using a quadratic model!

[.lesson-instruction]
Complete @printable-exercise{model-speed-v-mpg.adoc}


=== Synthesize

You've had a chance to experiment with quadratic models in vertex form:

@center{@math{y=a(x−h)^2+k}}

* How do you translate a parabola left and right?
** Change the value of @math{h}
* How do you translate a parabola up and down?
** Change the value of @math{k}
* How do you make a parabola "narrower" or "wider"?
** Change the value of @math{a}

* What was the highest @math{R^2} you were able to get? What model was it?
** Responses will vary
* Could a quadratic model be used to fit a linear relationship?
** YES! If the coefficient of the quadratic term is zero, it's equivalent to a linear model.
