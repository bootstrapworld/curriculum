= Exploring Quadratic Models

@description{Students investigate quadratic relationships in data about Fuel Efficiency, using an inquiry-based model of sense-making, hypothesizing, modeling and testing. They are introduced to table transformations and inverse functions, which are used to fit quadratic models onto nonlinear data.}

@lesson-prereqs{exploring-linear-models}

@keywords{quadratic, square, coefficient}

[@lesson-intro-table]
|===

| Lesson Goals
| Students will be able to...

* Read and interpret real-world data, presented in a scatter plot
* Model quadratic relationships using functions

| Student-facing Lesson Goals
|

* Let's use Pyret to model quadratic relationships in data


| Materials
|[.materials-links]
@material-links

| Preparation
|
* All students should pull up their @online-exercise{program-list} and, open the @starter-file{alg2-fuel-efficiency}.

| Key Points For The Facilitator
|
* Unlike linear functions, which are governed by slope and y-intercept, quadratic functions are governed by the bevahior of _three_ factors.
* Students should gain an intuition for these factors by playing with them first in Desmos, then use them to fit a model in Pyret.
|===

== Looking for Patterns @duration{15 minutes}

=== Overview
Students explore the @starter-file{alg2-fuel-efficiency}, and create scatter plots to search for relationships between columns. They share and discuss their findings with the class, discovering the limitations of linear models.

=== Launch

When you're driving, what speed will save you the most money on gas?

[.lesson-instruction]
- Open the @starter-file{alg2-fuel-efficiency}
- From the File menu, select "Save a Copy", and click "Run".
- Working in pairs or small groups, complete the first section of @printable-exercise{pages/exploring-mpg.adoc}.

@teacher{Review student answers to confirm that students see a _non-linear_ relationship in the dataset with a relatively strong correlation. Students should generally agree that the relationship is a curve (parabola), which opens downwards and has a vertex at _roughly_ 45mpg.  **Make sure students have agreed on this vertex**, as its location is important for the next activity!}

=== Investigate

@center{@image{images/fuel-efficiency-quadratic.png}}

There's definitely a relationship here. Even though some cars are more efficient than others, fuel efficiency generally increases from 15 to around 40-60mph. But after about 60mph, fuel efficiency _decreases._

We also know that the best-possible linear model isn't very good!

[cols="^.^1a,^.^1a,^.^1a", frame="none", stripes="none"]
|===
| We could build linear models that fit the increasing half of the data...
| We could build linear models that fit the decreasing half of the data...
| We could build linear models that try to split the difference...

| @image{images/fuel-efficiency-linear1.png}
| @image{images/fuel-efficiency-linear2.png}
| @image{images/fuel-efficiency-linear3.png}
|===

...but all of them are so far away from so many points, and our @vocab{R&sup2;} is pretty bad.

[.lesson-instruction]
Complete the rest of @printable-exercise{pages/exploring-mpg.adoc}. Be ready to share back and describe the curve you drew.

@teacher{
Have students share their curves, encouraging them to identify where they "peak" and where they cross the bottom of the scatter plot (one option is to project the scatter plot on a whiteboard and have students come up and draw all of their curves on it). These locations will be important anchor concepts on which to build in the next section.
}

=== Synthesize

- Why don't linear models work for us?
- What kinds of curves did you draw to fit better?
- Are there any mathematical functions that look like those curves?

== Quadratic Functions @duration{25 minutes}

=== Overview
Students are introduced to quadratic models (vocabulary, uses, different forms, and more), and extend the model-fitting techniques from the @lesson-link{exploring-linear-models} lesson into quadratic relationships.

=== Launch

Linear models are great for fitting simple relationships. But the real world isn't so simple, and, more often than not, linear models are just too primitive to handle that complexity.

Relationships like the one in the fuel efficiency scatter plot are best described by a curve!

The graph of the first curved model we will learn about is described as u-shaped or looking like an arch. The graph of a @vocab{quadratic relationship} is often referred to as @vocab{parabola}.

@teacher{Teacher Note: Either project or distribute @opt-printable-exercise{classifying-plots.adoc}.}

[.lesson-instruction]
Which of these scatter plots do you think could be modeled with a quadratic function? + 

**Quadratic relationships show up all the time in the real world:**

- When an athlete is young, they improve as they get stronger and more skilled. But as they age, they begin to lose their speed and strength.
- A ball dropped from a tall building will get faster and faster as it falls.
- Many nutrients are good for you, and the more you take the healthier you are...up to a point. After that, too much of a mineral or vitamin can cause problems.

Sometimes the data only includes the _rising_ part of the parabola, sometimes it only includes the _falling_ part, and sometimes it includes both.

@teacher{Teacher Note: Decide whether to project or distribute copies of the @opt-printable-exercise{classifying-tables.adoc} page of to students.}

[.lesson-instruction]
Before we consider whether our data can be modeled by a quadratic relationship, let's think about what the table of a perfect quadratic relationship would look like. One of these two sequences shows a linear progression, while the other shows a quadratic progression. Which one do you think is which? What do you Notice? What do you Wonder?

[cols="^1a,^1a",frame="none"]
|===
|
[.sideways-pyret-table]
!===
! x !  0 ! 1 ! 2  !  3 !  4
! y !  5 ! 6 ! 9  ! 14 ! 21
!===

|
[.sideways-pyret-table]
!===
! x !  0 ! 1 ! 2  ! 3 !  4
! y !  0 ! 3 ! 6  ! 9 ! 12
!===

|===

[.lesson-point]
--
Linear functions grow by _fixed_ intervals. 

Quadratic functions grow by intervals that _increase_ by fixed amounts!
--

@optional Identify whether each of the remaining tables on @opt-printable-exercise{classifying-tables.adoc} is quadratic, linear or neither.

[.lesson-instruction]
Let's go back to our fuel efficiency dataset, there's a definite "rise and fall" pattern like some of the parabolas we just looked at... but there almost appears to be a "dip" around 40mph. Does that mean we shouldn't use a quadratic model? Why or why not?

@teacher{Have students discuss and share back with the class. If necessary, remind students that _models are - by defintion - approximations of the real world._ The fact that a parabola isn't a perfect fit doesn't mean that it's not a quadratic relationship!}

The existence of a "dip" like this is normal in real data, but it doesn't mean that the overall shape of this relationship isn't quadratic. There's no such thing as a perfect model! If we try to draw a parabola through this dataset, we wind up with something like the image below:

@center{@image{images/fuel-efficiency-fit.png, 600}}

=== Investigate

[.lesson-instruction]
- Linear relationships can be described with terms like "slope" and "y-intercept". But what about quadratic relationships? Do parabolas have slope?
** No. They curve because they _do not_ have a constant rate of change.
- Do all parabolas have y-intercepts?
** No. Some do and some don't!
- What do you think the other important parts of a parabola might be?

[cols=".^3a,^.^1a", stripes="none", frame="none"]
|===
|
- @vocab{vertex} - In a quadratic relationship, the vertex is the point at which a parabola "changes direction", and goes from climbing to sinking (or vice versa). 

[.indentedpara]
--
- @vocab{maxima} - In a parabola that "opens down", the vertex is at the highest point
- @vocab{minima} - In a parabola that "opens up", the vertex is at the lowest point

--

| @image{images/opens.png, 175}

| 
- @vocab{axis of symmetry} - An imaginary vertical line through the @vocab{vertex} that splits the curve into two congruent parts that mirror each other. 

|

|
- @vocab{y-intercept} - Like linear models, parabolas always cross the y-axis once when x=0.
|  @image{images/y-intercept.png, 175}

|
- @vocab{x-intercepts} / @vocab{roots} / @vocab{zeros} - A quadratic function can cross the x-axis once, twice, or not at all.

|
@image{images/roots.png, 200}
|===

[.lesson-instruction]
Turn to @printable-exercise{parabolas.adoc}

[.strategy-box, cols="1", grid="none", stripes="none"]
|===

|
@span{.title}{Going Deeper: Interaction Effects}

We often think about variables of a model being _independent_ from one another, each contributing a little to the outcome we are measuring. But sometimes one input will amplify the result of another input, meaning their combined contribution is greater than the sum of their separate contributions.

A quadratic relationship often means that one or more variables is _interacting_ with another variable. In our miles-per-gallon example, it turns out that a linear increase in speed has a _more than linear effect_ on mpg!
|===

=== Synthesize


== Fitting Quadratic Models @duration{15 minutes}

=== Overview
Students apply their understanding of coefficients in vertex form to fit a quadratic model for the fuel efficiency dataset

=== Launch

We've already come to some conclusions about the @vocab{vertex} of our parabola, where our model predicts the greatest fuel-efficiency: *45mph*. That makes Vertex Form a useful place to start, since we already know the value of @math{h}:

@center{_Vertex Form:_ @math{y=a(x-h)^2+k} @hspace{3em}  @math{h:} }


@teacher{Now we need to figure out the values of @math{a} and @math{k}.}

But what do each of the coefficients in Vertex Form mean?

[.lesson-instruction]
- Open @starter-file{alg2-exploring-quadratics} in Desmos.
- Use Desmos to complete @printable-exercise{graphing-models.adoc}.

=== Investigate

[.lesson-instruction]
- Complete @printable-exercise{model-speed-v-mpg.adoc}

=== Synthesize
* What was the highest @math{R^2} you were able to get? What model was it?
** Responses will vary
* Could a quadratic model be used to fit a linear relationship?
** YES! If the coefficient of the quadratic term is zero, it's equivalent to a linear model.
* Do you notice anything interesting about the values of @math{h} and @math{k}?
** They are the coordinates of the vertex!

== Other Forms of Quadratic Models

=== Overview

=== Launch

=== Investigate

Just as there are different forms of linear models and we might choose to use one display over another, depending on what information we have available to us or are most interested in, there are several form of quadratic models:

[cols="^1a,^1a,^1a", options="header"]
|===
| Standard Form 		| Vertex Form			| Factored Form
| @math{y=ax^2+bx+c}	| @math{y=a(x−h)^2+k}	| @math{y=a(x−r_1)(x−r_2)}
<| 
- c: y-intercept
<|
- h: x-coordinate of the vertex
- k: y-coordinate of the vertex
<|
- a: determines whether the parabola opens up or down and how steep the curve is
- @math{r_1}: root or x-intercept
- @math{r_2}: other root or x-intercept
|===

And, depending on what part of the model we care about most, we might choose to use one display over another:

- **Standard Form** makes it easy to find the @vocab{y-intercept} of the parabola
- **Vertex Form** makes it easy to find the @vocab{vertex} (@vocab{minima} or @vocab{maxima}) and @vocab{axis of symmetry} of the parabola
- **Factored Form** makes it easy to find the @vocab{roots} of the parabola

=== Synthesize

@comment{
== Transforming Quadratic Functions

You've had a chance to experiment with quadratic models in vertex form:

@center{@math{y=a(x−h)^2+k}}

* How do you translate a parabola left and right?
** Change the value of @math{h}
* How do you translate a parabola up and down?
** Change the value of @math{k}
* How do you make a parabola "narrower" or "wider"?
** Change the value of @math{a}

* If you were fitting a quadratic model in vertex form to a scatter plot, which coefficient would you try to get right _first?_ Which one would you worry about _last?_

}

== Additional Exercises

- @opt-printable-exercise{classifying-defs.adoc}
- @opt-printable-exercise{match-graph-f.adoc} 
- @opt-printable-exercise{match-graph-v.adoc}
