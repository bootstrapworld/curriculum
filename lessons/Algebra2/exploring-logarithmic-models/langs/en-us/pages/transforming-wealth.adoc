= Transforming Data

For this page, you'll need to the  @online-exercise{https://code.pyret.org/editor#share=1StX6mmWMYPQOpH8ab1WiAlvPYeMlMEAD, Countries of the World Starter File} open on your computer. __If you haven't already__, select **Save a Copy** from the "File" menu to make a copy of the file that's just for you.

@n Type `albania["pc-gdp"] / 2`. What does this code do? @fitb{}{@ifsoln{Looks up the `pc-gdp` column in Albania, and divides it by 2}}

@n Find the contract for the `transform-pc-gdp` function. What is its Domain? @fitb{5em}{@ifsoln{Row}} Range? @fitb{}{@ifsoln{Number}}

@n Read the code for `transform-pc-gdp` carefully, then type `transform-pc-gdp(albania)`. What does this function do?

@fitb{}{@ifsoln{looks up the value of `pc-gdp` and divides it by 2}}

@vspace{1ex}

Note: This program also includes code which **defines a new Table** using a function called `build-column`. Find the definition of `countries2` in your code, then evaluate `countries2` in the Interactions Area. Be sure to scroll all the way to the right!

@n What does @show{(code '(build-column countries-table "pc-gdp / 2" transform-pc-gdp))} do?

@fitb{}{@ifsoln{it makes a new table, taking the adding a column called `pc-gdp / 2` by applying `transform-pc-gdp` to each Row.}}

@fitb{}{}

@fitb{}{}

@n Try using `lr-plot` with `countries2` and the new column. What was your @math{R^2} this time? @fitb{}{@ifsoln{0.413}}

@n Try changing `transform-pc-gdp` so it _doubles_ the `pc-gdp`, and adjust the new column-name accordingly. Try using `lr-plot` again. What was your @math{R^2} this time? @fitb{}{@ifsoln{0.413}}

@vspace{2ex}

@center{**Stop here, and discuss with the class.**}

@vspace{1ex}

@n Change the definition of `transform-pc-gdp` to take the _log_ of the per-capita gdp. Instead of calling our new column `pc-gdp / 2`, what would be a better name? @fitb{}{@ifsoln{`log(pc-gdp)`}}

@n Try using `lr-plot` again. What was your @math{R^2} this time? @fitb{}{@ifsoln{0.663}}

@n Write the function representing the optimal linear model below:

@center{
 @math{f(x) =} @fitbruby{8em}{@ifsoln{@math{5.169}}}{slope}x + @fitbruby{8em}{@ifsoln{24.264}}{y-intercept} @hspace{5em} @show{(code '(define (f x) (+ (* (?ANS 5.169) x) (?ANS 24.264))))}
}

@vspace{2ex}

@center{**Stop here, and discuss with the class.**}

@vspace{1ex}

@n Compose your log transformation with the linear function you wrote above.

@center{
 @math{f(x) =} @fitbruby{8em}{@ifsoln{@math{5.169}}}{log coefficient} @math{log(x) +} @fitbruby{8em}{@ifsoln{24.264}}{y-intercept} @hspace{5em} @show{(code '(define (f x) (+ (* (?ANS 5.169) (log x)) (?ANS 24.264))))}
}

@n Try using `fit-model` with your new model, fitting it to the original, un-transformed dataset. What is @math{R^2} now? @fitb{}{}
