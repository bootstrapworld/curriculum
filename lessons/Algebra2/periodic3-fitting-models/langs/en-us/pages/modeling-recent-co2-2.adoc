= Modeling Recent Carbon Dioxide Levels (continued)
++++
<style>
/* Make autonums inside tables look consistent with those outside */
td .autonum::after { content: ')' !important; }

/* Tweak table display */
td { padding: 0 !important; }
td .codetwo { color: black; background: none; }
table table td { color: inherit !important; padding: 3px 0 !important; }
body .center { padding: 0; }
.directions p { line-height: 1.75 !important; }
table+.paragraph .autonum {padding-top: 0; }

/* Shorten fill in the blanks, and give fitbrubies more vertical space */
.fitb, .fitbruby { min-width: 2em; }
.indentedpara .fitbruby { padding-top: 0.8rem; }
.studentAnswerMedium { min-width: 70pt !important; }
.fitbruby{ margin-bottom: 1rem; }
.ruby { bottom: -13px !important; }
</style>
++++


@define{COtwo}{@math{\text{CO}_2}}
@do{
(define-values (hi lo lo-dateA lo-dateB) (values 424 415.74 2022.708 2023.708))
(define p (abs (- lo-dateA lo-dateB)))
(define a 4.13)
(define b 6.28)
(define k 419.87)
(define h 2023.1)
(define h-cos 2023.35)
}

@define{hi}{@show{hi}}
@define{lo}{@show{lo}}
@define{lo-dateA}{@show{lo-dateA}}
@define{lo-dateB}{@show{lo-dateB}}
@define{p}{@show{(round p)}}
@define{a}{@show{a}}
@define{b}{@show{b}}
@define{k}{@show{k}}
@define{h}{@show{h}}
@define{h-cos}{@show{h-cos}}


@link-instructions{
This page relies on the @starter-file{alg2-co2}. Make sure you have it open on your computer!
}

== Fitting Your Periodic Model

@n Define a periodic model using the values you computed for @math{a}, @math{k}, @math{h} and @math{b} on @printable-exercise{modeling-recent-co2.adoc}.

@teacher{Students horizontal shift estimates may vary slightly from this function definition.}

@vspace{1ex}

[cols="1a, .^12a", frame="none", stripes="none"]
|===
| *Function Notation*
|

@math{periodic(x) =}
@fitbruby{70pt}{@ifsoln{@a}}{amplitude (@math{a})} @math{\times}@math{sin}(
@fitbruby{70pt}{@ifsoln{@b}}{frequency (@math{b})} @math{(x -}
@fitbruby{70pt}{@ifsoln{@h}}{horizontal shift (@math{h})})) +
@fitbruby{70pt}{@ifsoln{@k}}{vertical shift (@math{k})}

| @vspace{1ex} +
*Pyret Notation*
|
@show{(code `(define (periodic x) (+ (* (?ANS ,a) (sin (* (?ANS ,b) (- x (?ANS ,h))))) (?ANS ,k))))}
|===

@vspace{1ex}

Then update the `periodic` function definition in your starter file to match what you've just written.

@n Use `fit-model` to fit your `periodic` model to the data in the `recent-table`. What S-value do you get? @fitb{}{@ifsoln{Answers will vary slightly.  ~1.2 }}

@n What does this model actually mean? Fill in the blanks below, and read the completed model aloud with your partner.

@vspace{1ex}

@indented{
_Between the end of 2022 and 2023, the amount of @math{CO_2} in the air fluctuated between @fitbruby{6em}{@ifsoln{415.74}}{lowest} and @fitbruby{6em}{@ifsoln{424}}{highest} parts-per-million. This pattern appears to be @vocab{periodic}, with an amplitude of @fitbruby{6em}{@ifsoln{4.13}}{amplitude} rising and falling around a @vocab{midline} of @fitbruby{6em}{@ifsoln{419.87}}{midline}. With 1 year representing a full cycle, we expect this pattern to repeat each year for a frequency of @fitbruby{5em}{@ifsoln{@math{2pi}}}{frequency}._
}

== How well does our model predict @math{CO_2} levels for other years?

You built your model using the `recent-table`, which covers the most recent full year of our dataset.

@n Let's see how well if fits the broader dataset. In Pyret, fit your model to the `modern-table`. What @math{S}-value do you get? @fitb{}{@ifsoln{Answers will vary slightly.  ~17.8 }}

@vspace{1ex}

[cols="10a,1,10a", grid="none", frame="none"]
|===
| @n Sketch your model on the scatter plot below.

@ifnotsoln{@center{@image{../images/modern-co2-scatter.png, 300}}}
@ifsoln{@center{@image{../images/modern-co2-model-soln.png, 300}}}

|
| @n Describe what changes you could make to your model so that it would fit the data better.

@fitb{}{@ifsoln{Answers will vary. We could change the y-intercept.}}

@fitb{}{@ifsoln{It needs to be rotated so that the wave undulates around}}

@fitb{}{@ifsoln{a diagonal line rather than a horizontal line.}}

@fitb{}{}

@fitb{}{}

@fitb{}{}

|===

@star Try translating the definition you wrote for `periodic` so that it uses  @math{\text{cosine}}  instead of @math{\text{sine}}:

@vspace{1ex}

[cols="1a, .^12a", frame="none", stripes="none"]
|===
|*Function Notation*
|

@math{periodic(x) =}
@fitbruby{70pt}{@ifsoln{@a}}{amplitude (@math{a})} @math{\times}@math{cos}(
@fitbruby{70pt}{@ifsoln{@b}}{frequency (@math{b})} @math{(x -}
@fitbruby{70pt}{@ifsoln{@h-cos}}{horizontal shift (@math{h})})) +
@fitbruby{70pt}{@ifsoln{@k}}{vertical shift (@math{k})}

| @vspace{1ex} +
*Pyret Notation*
|
@show{(code `(define (periodic x) (+ (* (?ANS ,a) (cos (* (?ANS ,b) (- x (?ANS ,h-cos))))) (?ANS ,k))))}
|===
